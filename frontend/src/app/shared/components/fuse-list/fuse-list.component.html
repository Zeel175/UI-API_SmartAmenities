<!-- fuse-list.component.html :contentReference[oaicite:3]{index=3} -->
<div class="flex flex-auto overflow-hidden">
  <div class="flex flex-auto flex-col overflow-hidden sm:mb-18 sm:overflow-y-auto">

    <!-- ① Column Filters -->
    <!-- <app-column-menu
      [columns]="columns"
      (columnChange)="onColumnChange($event)">
    </app-column-menu> -->

    <!-- ② Card + Table Container -->
    <mat-card class="user-list-table mt-4 mb-4 mx-6 md:mx-8 mat-elevation-z2">
      <div class="overflow-auto">

        <!-- ③ Data Table -->
        <table mat-table [dataSource]="dataSource" matSort class="min-w-full">

          <!-- Dynamic data columns -->
          <ng-container *ngFor="let col of visibleColumns" [matColumnDef]="col.prop">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <div class="flex items-center justify-between">
                <span>{{ col.name }}</span>
                <!-- per-column menu trigger -->
                <app-column-menu [columns]="columns" (columnChange)="onColumnChange($event)"
                  class="!p-0"></app-column-menu>
              </div>
            </th>
            <td mat-cell *matCellDef="let element">
              <ng-container *ngIf="col.cellTemplate; else defaultCell" [ngTemplateOutlet]="col.cellTemplate"
                [ngTemplateOutletContext]="{ $implicit: element[col.prop] }">
              </ng-container>
              <ng-template #defaultCell>
                {{ element[col.prop] }}
              </ng-template>
            </td>
          </ng-container>

          <!-- Actions column -->
          <ng-container matColumnDef="actions" *ngIf="displayedColumns.includes('actions')">
            <th mat-header-cell *matHeaderCellDef> Actions </th>
            <td mat-cell *matCellDef="let element">
              <!-- ✅ If parent gave a template, render it; else show default buttons -->
    <ng-container *ngIf="actionsTemplate; else defaultActions"
                  [ngTemplateOutlet]="actionsTemplate"
                  [ngTemplateOutletContext]="{ $implicit: element }">
    </ng-container>
    <ng-template #defaultActions>
              <button *ngIf="actions.edit" mat-icon-button (click)="onEdit(element.id)">
                <mat-icon>edit</mat-icon>
              </button>
              <button *ngIf="actions.delete" mat-icon-button (click)="onDelete(element.id)">
                <mat-icon>delete</mat-icon>
              </button>
              <button *ngIf="actions.email" mat-icon-button (click)="onEmail(element.id)">
                <mat-icon>email</mat-icon>
              </button>
              </ng-template>
            </td>
          </ng-container>

          <!-- Header & Rows -->
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row
    *matRowDef="let row; columns: displayedColumns"
    [ngClass]="rowClassFn ? rowClassFn(row) : null">
</tr>
        </table>
      </div>

      <!-- ④ Paginator -->
      <mat-paginator
        *ngIf="showPaginator"
        class="px-6 pb-6 pt-2"
        [length]="totalItems"
        [pageSize]="pageSize"
        [pageIndex]="pageIndex"
        [pageSizeOptions]="[5, 10, 25, 50]"
        (page)="onPageChange($event)"
      >
      </mat-paginator>
    </mat-card>
  </div>
</div>
